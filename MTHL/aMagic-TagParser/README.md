# aMagic-TagParser
PHP-–∫–ª–∞—Å—Å –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ (–≤ —Å—Ç–∏–ª–µ CSS-—Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤) –≤ –≤–∞–ª–∏–¥–Ω—ã–π HTML.

### –ö–æ–¥ –ü–∞—Ä—Å–µ—Ä–∞ –¢–µ–≥–æ–≤ `class TagParser()` (PHP):

- 09.04.2025–≥., –∞–≤—Ç–æ—Ä –ê–ª–µ–∫—Å–µ–π –ù–µ—á–∞–µ–≤, –≥. –ú–æ—Å–∫–≤–∞, +7(999)003-90-23, nechaev72@list.ru

## –õ–∏—Ü–µ–Ω–∑–∏—è <a name="–ª–∏—Ü–µ–Ω–∑–∏—è"></a>
MIT License. –°–≤–æ–±–æ–¥–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è.

---

# –ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è `TagParser`

## –°–ª–∞–π–¥ 1: –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- ‚úÖ –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ CSS-—Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤ ‚Üí HTML
- üåÄ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ –æ—Ç—Å—Ç—É–ø—ã
- ‚ö° –ê–≤—Ç–æ–∑–∞–∫—Ä—ã—Ç–∏–µ void-—ç–ª–µ–º–µ–Ω—Ç–æ–≤
- üîß –ì–∏–±–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∞—Ç—Ä–∏–±—É—Ç–æ–≤

## –°–ª–∞–π–¥ 2: –°–∏–Ω—Ç–∞–∫—Å–∏—Å
```css
div#header.main[data-role='banner']
  ul.nav
    li –î–æ–º–æ–π
    li –û –Ω–∞—Å
```

## –°–ª–∞–π–¥ 3: –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞
```html
<div id="header" class="main" data-role="banner">
  <ul class="nav">
    <li>–î–æ–º–æ–π</li>
    <li>–û –Ω–∞—Å</li>
  </ul>
</div>
```

## –°–ª–∞–π–¥ 4: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –æ—Ç—Å—Ç—É–ø–æ–≤
```
–î–æ–ø—É—Å—Ç–∏–º—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã:
‚Ä¢ 2 –ø—Ä–æ–±–µ–ª–∞
‚Ä¢ 1 —Ç–∞–±
‚Ä¢ –°–º–µ—à–∞–Ω–Ω—ã–µ (—Ç–∞–± + –ø—Ä–æ–±–µ–ª—ã)
```

## –°–ª–∞–π–¥ 5: –ò—Ç–æ–≥–∏
- –£—Å–∫–æ—Ä—è–µ—Ç –≤–µ—Ä—Å—Ç–∫—É –≤ 3 —Ä–∞–∑–∞ üöÄ
- –ú–∏–Ω–∏–º—É–º –∫–æ–¥–∞ –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä
- –ò–¥–µ–∞–ª–µ–Ω –¥–ª—è –ø—Ä–æ—Ç–æ—Ç–∏–ø–∏—Ä–æ–≤–∞–Ω–∏—è

---

## –°–∏–Ω—Ç–∞–∫—Å–∏—Å <a name="—Å–∏–Ω—Ç–∞–∫—Å–∏—Å"></a>
### –°—Ç—Ä–æ–∫–∞ —à–∞–±–ª–æ–Ω–∞
```
[–æ—Ç—Å—Ç—É–ø—ã][—Ç–µ–≥][#id][.class][[–∞—Ç—Ä–∏–±—É—Ç—ã]][ —Ç–µ–∫—Å—Ç]
```
#### –ü—Ä–∏–º–µ—Ä
```
div#header.container[data-role='main'] –ó–∞–≥–æ–ª–æ–≤–æ–∫
    ^^     ^            ^                 ^
    |      |            |                 |
    –æ—Ç—Å—Ç—É–ø—ã          –∞—Ç—Ä–∏–±—É—Ç—ã           —Ç–µ–∫—Å—Ç
```

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
| –≠–ª–µ–º–µ–Ω—Ç       | –ü—Ä–∏–º–µ—Ä              | –†–µ–∑—É–ª—å—Ç–∞—Ç                     |
|---------------|---------------------|-------------------------------|
| –¢–µ–≥           | `div`               | `<div>`                       |
| ID            | `#main`             | `id="main"`                   |
| –ö–ª–∞—Å—Å—ã        | `.btn.large`        | `class="btn large"`           |
| –ê—Ç—Ä–∏–±—É—Ç—ã      | `[data-id='5']`     | `data-id="5"`                 |
| –¢–µ–∫—Å—Ç         | `–¢–µ–∫—Å—Ç`             | `>–¢–µ–∫—Å—Ç</tag>`                |
| Void-—ç–ª–µ–º–µ–Ω—Ç—ã | `img[src='pic.jpg']`| `<img src="pic.jpg">`         |

---

## –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ <a name="—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ-–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏"></a>
### 1. –°–º–µ—à–∞–Ω–Ω—ã–µ –æ—Ç—Å—Ç—É–ø—ã
```php
$input = "
ul
\tli (—Ç–∞–±)
  \tli (—Ç–∞–± + 2 –ø—Ä–æ–±–µ–ª–∞)
";
```
**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è:** –∫–æ–º–±–∏–Ω–∞—Ü–∏—è —Ç–∞–±–æ–≤ ( `\t` ) –∏ –ø—Ä–æ–±–µ–ª–æ–≤.

### 2. –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å
```php
$input = "
div
  div
    p –¢–µ–∫—Å—Ç
";
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```html
<div>
  <div>
    <p>–¢–µ–∫—Å—Ç</p>
  </div>
</div>
```

### 3. –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã
```php
$input = "input[type='email' required]";
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```html
<input type="email" required>
```

---

–†–µ–∞–ª–∏–∑—É–µ–º —Ç–∞–∫–æ–π –ø–∞—Ä—Å–µ—Ä –Ω–∞ PHP. –û–Ω –±—É–¥–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –≤–∏–¥–∞ `tag.class#id[attr="value"] –¢–µ–∫—Å—Ç` —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ –æ—Ç—Å—Ç—É–ø—ã (2 –∏–ª–∏ 4 –ø—Ä–æ–±–µ–ª–∞).

```php
class TagParser {
    // –¢–µ–≥–∏ –±–µ–∑ –∑–∞–∫—Ä—ã–≤–∞—é—â–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ (void elements)
    const VOID_TAGS = [
        'area', 'base', 'br', 'col', 'embed', 'hr', 'img',
        'input', 'link', 'meta', 'param', 'source', 'track', 'wbr'
    ];

    public function parse(string $input): string {
        $lines = explode("\n", trim($input));
        $stack = [];
        $prevIndent = 0;
        $output = '';

        foreach ($lines as $line) {
            // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏
            if (trim($line) === '') continue;

            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —É—Ä–æ–≤–µ–Ω—å –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏
            preg_match('/^(\s*)/', $line, $matches);
            //$indent = strlen($matches[1]);
			$indent = strlen(str_replace("\t", "  ", $matches[1])); // 1 —Ç–∞–± = 2 –ø—Ä–æ–±–µ–ª–∞
            $content = trim($line);

            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Ç–µ–≥–∏ –ø—Ä–∏ —É–º–µ–Ω—å—à–µ–Ω–∏–∏ –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏
            while ($indent < $prevIndent) {
                array_pop($stack);
                $prevIndent -= 2;
            }

            // –ü–∞—Ä—Å–∏–º —Ç–µ–∫—É—â—É—é —Å—Ç—Ä–æ–∫—É
            $node = $this->parseLine($content);
            $output .= $this->renderTag($node, $stack);

            // –î–æ–±–∞–≤–ª—è–µ–º –≤ —Å—Ç–µ–∫ –µ—Å–ª–∏ —Ç–µ–≥ –Ω–µ void
            if (!in_array($node['tag'], self::VOID_TAGS)) {
                array_push($stack, $node['tag']);
                $prevIndent += 2;
            }
        }

        // –ó–∞–∫—Ä—ã–≤–∞–µ–º –æ—Å—Ç–∞–≤—à–∏–µ—Å—è —Ç–µ–≥–∏
        while (!empty($stack)) {
            $output .= '</' . array_pop($stack) . '>';
        }

        return $output;
    }

    private function parseLine(string $line): array {
        // –†–µ–≥—É–ª—è—Ä–∫–∞ –¥–ª—è —Ä–∞–∑–±–æ—Ä–∞ —Å—Ç—Ä–æ–∫–∏
        preg_match('/
            ^
            (?:([a-z]+))?                # –¢–µ–≥
            (?:#([\w-]+))?               # ID
            (?:\.([\w.-]+))?             # –ö–ª–∞—Å—Å—ã
            (?:\[(.*?)\])?               # –ê—Ç—Ä–∏–±—É—Ç—ã
            (?:\s+(.+))?                 # –¢–µ–∫—Å—Ç
            $
        /xi', $line, $matches);

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∞—Ç—Ä–∏–±—É—Ç–æ–≤
        $attrs = [];
        if (!empty($matches[4])) {
            preg_match_all('/(\w+)=("[^"]*"|\S+)/', $matches[4], $attrPairs);
            foreach ($attrPairs[1] as $i => $name) {
                $attrs[$name] = trim($attrPairs[2][$i], '"');
            }
        }

        return [
            'tag' => $matches[1] ?? 'div',
            'id' => $matches[2] ?? '',
            'classes' => $matches[3] ? explode('.', $matches[3]) : [],
            'attrs' => $attrs,
            'text' => $matches[5] ?? ''
        ];
    }

    private function renderTag(array $node, array $stack): string {
        $tag = $node['tag'];
        $attrs = [];

        if ($node['id']) {
            $attrs[] = 'id="' . htmlspecialchars($node['id']) . '"';
        }

        if (!empty($node['classes'])) {
            $attrs[] = 'class="' . htmlspecialchars(implode(' ', $node['classes'])) . '"';
        }

        foreach ($node['attrs'] as $name => $value) {
            $attrs[] = htmlspecialchars($name) . '="' . htmlspecialchars($value) . '"';
        }

        $html = '<' . $tag . ($attrs ? ' ' . implode(' ', $attrs) : '') . '>';

        if (!in_array($tag, self::VOID_TAGS)) {
            $html .= htmlspecialchars($node['text']);
        }

        return $html;
    }
}
```


### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```PHP
$input = "
ul.menu#main
  li.item –ü—É–Ω–∫—Ç 1
  li.item.active –ü—É–Ω–∫—Ç 2
  input[type='text' placeholder='–í–≤–µ–¥–∏—Ç–µ –∏–º—è']
";

$parser = new TagParser();
echo $parser->parse($input);
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç:
```html
<ul id="main" class="menu">
  <li class="item">–ü—É–Ω–∫—Ç 1</li>
  <li class="item active">–ü—É–Ω–∫—Ç 2</li>
  <input type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è">
</ul>
```

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –ø–∞—Ä—Å–µ—Ä–∞:
1. **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ –æ—Ç—Å—Ç—É–ø—ã** (2 –ø—Ä–æ–±–µ–ª–∞ –Ω–∞ —É—Ä–æ–≤–µ–Ω—å)
2. **–ê–≤—Ç–æ–∑–∞–∫—Ä—ã—Ç–∏–µ —Ç–µ–≥–æ–≤** –¥–ª—è void-—ç–ª–µ–º–µ–Ω—Ç–æ–≤ (input, img –∏ –¥—Ä.)
3. **–≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª–æ–≤** —á–µ—Ä–µ–∑ htmlspecialchars()
4. **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã:**
   - –¢–µ–≥: `div` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
   - ID: `#id`
   - –ö–ª–∞—Å—Å—ã: `.class1.class2`
   - –ê—Ç—Ä–∏–±—É—Ç—ã: `[attr1="val1" attr2]`
   - –¢–µ–∫—Å—Ç: –ø–æ—Å–ª–µ –∞—Ç—Ä–∏–±—É—Ç–æ–≤

### –ê–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è:
1. **Slim** (Ruby) - –ø–æ—Ö–æ–∂–∏–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å
2. **Emmet** (–∞–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä—ã) - —Ç—Ä–µ–±—É–µ—Ç –∫–æ–º–ø–∏–ª—è—Ü–∏–∏
3. **Pug/Jade** - –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å —Å –ª–æ–≥–∏–∫–æ–π

–¢–∞–∫–æ–π –ø–∞—Ä—Å–µ—Ä –ø–æ–¥–æ–π–¥–µ—Ç –¥–ª—è:
- –ë—ã—Å—Ç—Ä–æ–≥–æ –ø—Ä–æ—Ç–æ—Ç–∏–ø–∏—Ä–æ–≤–∞–Ω–∏—è
- –ì–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Å—Ç—Ä–∞–Ω–∏—Ü
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π UI-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- –£–ø—Ä–æ—â–µ–Ω–∏—è –≤–µ—Ä—Å—Ç–∫–∏ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

–î–ª—è —Å–ª–æ–∂–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–µ —à–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä—ã (Twig, Blade), –Ω–æ —ç—Ç–æ—Ç –≤–∞—Ä–∏–∞–Ω—Ç –æ—Ç–ª–∏—á–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ.


–î–∞, —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π –∫–ª–∞—Å—Å `TagParser` –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—É—é –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å. –ü—Ä–∏–≤–µ–¥–µ–º –ø—Ä–∏–º–µ—Ä —Å –¥—Ä–µ–≤–æ–≤–∏–¥–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –ø–∞–ø–æ–∫ –∏ —Ñ–∞–π–ª–æ–≤:

```php
$input = "
ul.tree
  li.folder
    span –ü–∞–ø–∫–∞ 1
    ul
      li.file –§–∞–π–ª 1
      li.folder
        span –ü–∞–ø–∫–∞ 2
        ul
          li.file –§–∞–π–ª 2
  li.folder
    span –ü–∞–ø–∫–∞ 3
";

$parser = new TagParser();
echo $parser->parse($input);
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```html
<ul class="tree">
  <li class="folder">
    <span>–ü–∞–ø–∫–∞ 1</span>
    <ul>
      <li class="file">–§–∞–π–ª 1</li>
      <li class="folder">
        <span>–ü–∞–ø–∫–∞ 2</span>
        <ul>
          <li class="file">–§–∞–π–ª 2</li>
        </ul>
      </li>
    </ul>
  </li>
  <li class="folder">
    <span>–ü–∞–ø–∫–∞ 3</span>
  </li>
</ul>
```

### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:
1. **–û—Ç—Å—Ç—É–ø—ã –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç —É—Ä–æ–≤–µ–Ω—å –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏.** –ö–∞–∂–¥—ã–µ 2 –ø—Ä–æ–±–µ–ª–∞ ‚Äî –Ω–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å.
2. **–°—Ç–µ–∫ —Ç–µ–≥–æ–≤** –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –æ—Ç–∫—Ä—ã—Ç—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã. –ü—Ä–∏ —É–º–µ–Ω—å—à–µ–Ω–∏–∏ –æ—Ç—Å—Ç—É–ø–∞ —Ç–µ–≥–∏ –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.
3. **Void-—Ç–µ–≥–∏** (–Ω–∞–ø—Ä–∏–º–µ—Ä, `<img>`) –Ω–µ —Ç—Ä–µ–±—É—é—Ç –∑–∞–∫—Ä—ã–≤–∞—é—â–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤.

### –ü—Ä–∏–º–µ—Ä —Å —Ç–µ–≥–∞–º–∏ —Ä–∞–∑–Ω—ã—Ö —É—Ä–æ–≤–Ω–µ–π:
```php
$input = "
div
  div
    div
      p –ì–ª—É–±–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å
  div
    p –í–æ–∑–≤—Ä–∞—Ç –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å
";

// –†–µ–∑—É–ª—å—Ç–∞—Ç:
// <div>
//   <div>
//     <div>
//       <p>–ì–ª—É–±–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å</p>
//     </div>
//   </div>
//   <div>
//     <p>–í–æ–∑–≤—Ä–∞—Ç –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å</p>
//   </div>
// </div>
```

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ —É–ª—É—á—à–µ–Ω–∏—è:
1. **–¢–∞–±—ã vs –ø—Ä–æ–±–µ–ª—ã:** –°–µ–π—á–∞—Å –ø–∞—Ä—Å–µ—Ä —Å—á–∏—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–æ–±–µ–ª—ã. –î–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Ç–∞–±–æ–≤ –∑–∞–º–µ–Ω–∏—Ç–µ:
   ```php
   $indent = strlen(str_replace("\t", "  ", $matches[1])); // 1 —Ç–∞–± = 2 –ø—Ä–æ–±–µ–ª–∞
   ```
2. **–û—à–∏–±–∫–∏ —Ñ–æ—Ä–º–∞—Ç–∞:** –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –æ—Ç—Å—Ç—É–ø—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, 3 –ø—Ä–æ–±–µ–ª–∞) –º–æ–≥—É—Ç –Ω–∞—Ä—É—à–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É.
3. **–≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:** –¢–µ–∫—Å—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —ç–∫—Ä–∞–Ω–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ `htmlspecialchars()`.

–¢–∞–∫–æ–π –ø–∞—Ä—Å–µ—Ä –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –±–∞–∑–æ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤. –î–ª—è —Å–ª–æ–∂–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `phug/pug`, –Ω–æ —ç—Ç–æ—Ç –≤–∞—Ä–∏–∞–Ω—Ç –æ—Ç–ª–∏—á–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –ª–µ–≥–∫–æ–≤–µ—Å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ.

–í–æ—Ç –ø—Ä–∏–º–µ—Ä —Ç–∞–±–ª–∏—Ü—ã —Å –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–º–∏ —è—á–µ–π–∫–∞–º–∏, –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–π –Ω–∞—à–∏–º –ø–∞—Ä—Å–µ—Ä–æ–º:

```php
$input = "
table.table-style[border='1']
  thead
    tr
      th[colspan='2'] –û—Å–Ω–æ–≤–Ω–æ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫
  tbody
    tr
      td[rowspan='2'] –û–±—ä–µ–¥–∏–Ω–µ–Ω–Ω–∞—è —è—á–µ–π–∫–∞
      td –Ø—á–µ–π–∫–∞ 1
    tr
      td –Ø—á–µ–π–∫–∞ 2
    tr
      td[colspan='2'] –ù–∏–∂–Ω–∏–π –∑–∞–≥–æ–ª–æ–≤–æ–∫
";

$parser = new TagParser();
echo $parser->parse($input);
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:**
```html
<table class="table-style" border="1">
  <thead>
    <tr>
      <th colspan="2">–û—Å–Ω–æ–≤–Ω–æ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td rowspan="2">–û–±—ä–µ–¥–∏–Ω–µ–Ω–Ω–∞—è —è—á–µ–π–∫–∞</td>
      <td>–Ø—á–µ–π–∫–∞ 1</td>
    </tr>
    <tr>
      <td>–Ø—á–µ–π–∫–∞ 2</td>
    </tr>
    <tr>
      <td colspan="2">–ù–∏–∂–Ω–∏–π –∑–∞–≥–æ–ª–æ–≤–æ–∫</td>
    </tr>
  </tbody>
</table>
```

### –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å —Å–ª–æ–∂–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã:
1. **–û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –∫–æ–ª–æ–Ω–æ–∫**  
   ```css
   td[colspan='3']
   ```
2. **–û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫**  
   ```css
   td[rowspan='2']
   ```
3. **–°–º–µ—à–∞–Ω–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã**  
   ```css
   td[data-id='5'][class='special']
   ```

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:
1. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –ª—é–±–∞—è –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å:
   ```php
   table
     tr
       td
         div.wrapper
           span.icon
           p.text
   ```
2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ —Ç–µ–≥–æ–≤ –¥–ª—è:
   - `<table>`
   - `<tr>`
   - `<td>`/`<th>`
   - `<thead>`/`<tbody>`

–î–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏ –ø–∞—Ä—Å–µ—Ä –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ HTML-–∞—Ç—Ä–∏–±—É—Ç—ã. –≠—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–ª–æ–∂–Ω—ã—Ö —Ç–∞–±–ª–∏—á–Ω—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä –±–µ–∑ —Ä—É—á–Ω–æ–≥–æ –Ω–∞–ø–∏—Å–∞–Ω–∏—è HTML.





# –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è –∫–ª–∞—Å—Å–∞ `TagParser`

## –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ
1. [–í–≤–µ–¥–µ–Ω–∏–µ](#–≤–≤–µ–¥–µ–Ω–∏–µ)
2. [–£—Å—Ç–∞–Ω–æ–≤–∫–∞](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞)
3. [–ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ](#–±–∞–∑–æ–≤–æ–µ-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ)
4. [–°–∏–Ω—Ç–∞–∫—Å–∏—Å](#—Å–∏–Ω—Ç–∞–∫—Å–∏—Å)
5. [–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏](#—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ-–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)
6. [–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫](#–æ–±—Ä–∞–±–æ—Ç–∫–∞-–æ—à–∏–±–æ–∫)
7. [–ü—Ä–∏–º–µ—Ä—ã](#–ø—Ä–∏–º–µ—Ä—ã)
8. [–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è](#–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è)
9. [–õ–∏—Ü–µ–Ω–∑–∏—è](#–ª–∏—Ü–µ–Ω–∑–∏—è)

---

## –í–≤–µ–¥–µ–Ω–∏–µ <a name="–≤–≤–µ–¥–µ–Ω–∏–µ"></a>
`TagParser` ‚Äî —ç—Ç–æ PHP-–∫–ª–∞—Å—Å –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ (–≤ —Å—Ç–∏–ª–µ CSS-—Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤) –≤ –≤–∞–ª–∏–¥–Ω—ã–π HTML. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç:
- –í–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ **–æ—Ç—Å—Ç—É–ø—ã** (2 –ø—Ä–æ–±–µ–ª–∞ –∏–ª–∏ 1 —Ç–∞–±)
- CSS-–∫–ª–∞—Å—Å—ã, ID, –∞—Ç—Ä–∏–±—É—Ç—ã
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ —Ç–µ–≥–æ–≤
- Void-—ç–ª–µ–º–µ–Ω—Ç—ã (`<img>`, `<input>` –∏ –¥—Ä.)

---

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ <a name="—É—Å—Ç–∞–Ω–æ–≤–∫–∞"></a>
–ü—Ä–æ—Å—Ç–æ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–ª–∞—Å—Å –≤ –≤–∞—à –ø—Ä–æ–µ–∫—Ç:
```php
require_once 'TagParser.php';
```

---

## –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ <a name="–±–∞–∑–æ–≤–æ–µ-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ"></a>
```php
$input = "
ul.menu#main
  li.item –ü—É–Ω–∫—Ç 1
  li.item.active –ü—É–Ω–∫—Ç 2
";

$parser = new TagParser();
echo $parser->parse($input);
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```html
<ul id="main" class="menu">
  <li class="item">–ü—É–Ω–∫—Ç 1</li>
  <li class="item active">–ü—É–Ω–∫—Ç 2</li>
</ul>
```

---



## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ <a name="–æ–±—Ä–∞–±–æ—Ç–∫–∞-–æ—à–∏–±–æ–∫"></a>
–ö–ª–∞—Å—Å –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏—è –≤ —Å–ª—É—á–∞—è—Ö:
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–æ–ø—É—Å–∫ —É—Ä–æ–≤–Ω—è)
- –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `attr='value`)

**–ü—Ä–∏–º–µ—Ä –æ–±—Ä–∞–±–æ—Ç–∫–∏:**
```php
try {
    $parser->parse($input);
} catch (TagParserException $e) {
    echo "–û—à–∏–±–∫–∞: " . $e->getMessage();
}
```

---

## –ü—Ä–∏–º–µ—Ä—ã <a name="–ø—Ä–∏–º–µ—Ä—ã"></a>
### –ü—Ä–∏–º–µ—Ä 1: –§–æ—Ä–º–∞
```php
$input = "
form#login[action='/auth']
  input[type='text' name='login']
  input[type='password' name='pass']
  button.btn[type='submit'] –í–æ–π—Ç–∏
";

echo $parser->parse($input);
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```html
<form id="login" action="/auth">
  <input type="text" name="login">
  <input type="password" name="pass">
  <button class="btn" type="submit">–í–æ–π—Ç–∏</button>
</form>
```

### –ü—Ä–∏–º–µ—Ä 2: –ú–µ–¥–∏–∞-–æ–±—ä–µ–∫—Ç
```php
$input = "
div.media
  img.thumb[src='avatar.jpg']
  div.content
    h3 –ó–∞–≥–æ–ª–æ–≤–æ–∫
    p –¢–µ–∫—Å—Ç
";
```

---

## –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è <a name="–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è"></a>
- –ù–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Å–∞–º–æ–∑–∞–∫—Ä—ã–≤–∞—é—â–∏—Ö—Å—è —Ç–µ–≥–æ–≤ (–∫—Ä–æ–º–µ void-—ç–ª–µ–º–µ–Ω—Ç–æ–≤)
- –ù–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `:` –≤ –∏–º–µ–Ω–∞—Ö –∫–ª–∞—Å—Å–æ–≤/ID
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≥–ª—É–±–∏–Ω–∞ –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏: 20 —É—Ä–æ–≤–Ω–µ–π

---


[GitHub Repository](https://github.com/yourname/tagparser) | [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](#–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è) | [–ü—Ä–∏–º–µ—Ä—ã](#–ø—Ä–∏–º–µ—Ä—ã)
