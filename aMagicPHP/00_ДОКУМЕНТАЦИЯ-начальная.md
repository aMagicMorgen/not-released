# Документация для aMagic.php

## Общее описание

aMagic.php - это скрипт для автоматической генерации структуры папок и файлов нового сайта. После первого запуска он создает необходимую структуру каталогов, базовые файлы и перемещает себя в папку `lib/aMagic/` для дальнейшего использования.

## Основные функции

### 1. Инициализация и настройки

```php
error_reporting(E_ALL);
ini_set('display_errors','on');
mb_internal_encoding('UTF-8');
```

- Включает вывод всех ошибок
- Устанавливает кодировку UTF-8

### 2. Создание структуры папок

Скрипт создает следующую структуру папок:
```
/
  /lib/aMagic/
  /static/
    /css/
    /scss/
    /js/
    /png/
    /jpg/
  /pages/ (или другая папка, указанная в $dirPage)
```

### 3. Основные функции

#### `html($html)`
- Очищает и минимизирует HTML-код
- Удаляет лишние пробелы, комментарии
- Оптимизирует теги

#### `tags($html, $blocks = null)`
- Анализирует HTML-документ с помощью DOMDocument
- Извлекает мета-теги, скрипты, стили и другие элементы
- Возвращает структурированный массив с элементами страницы

#### `aMagic($dirPage, $body, $aMagic)`
- Основная функция генерации HTML-страницы
- Объединяет все компоненты (head, header, body, footer)
- Обрабатывает секции страницы
- Возвращает готовый HTML-код

#### `formatS($html)` и `formatHtml($html)`
- Функции для форматирования HTML-кода
- `formatS` - простое форматирование с переносами строк
- `formatHtml` - полное форматирование с отступами (использует tidy)

#### `aMagicMenu()`
- Генерирует навигационное меню для панели управления
- Показывает список созданных страниц
- Содержит форму для создания новых страниц

## Конфигурация

Основные настройки содержатся в массиве `$configuration`:

```php
$configuration = [
    [
        'lang' => 'ru',
        'title' => 'назначьте $title в этом файле',
        'dirPage' => 'pages/',
        'attributes_body' => '',
        'sections' => 'section01',
        'pageName' => 'index'
    ],
    [
        'config' => 'config',
        'pageName' => 'index',
        'head' => 'head',
        'header' => 'header',
        'footer' => 'footer'
    ]
];
```

## Работа с файлами

Скрипт создает следующие основные файлы:

1. **config.php** - основной конфигурационный файл
2. **head.php** - содержит мета-теги, стили и скрипты для `<head>`
3. **header.php** - шапка сайта
4. **footer.php** - подвал сайта
5. **index.php** - главная страница
6. **aPages.php** - список созданных страниц

## Процесс работы

1. При первом запуске aMagic.php:
   - Создает структуру папок
   - Генерирует базовые файлы
   - Копирует себя в `lib/aMagic/` и удаляет оригинал

2. При последующих запусках через index.php:
   - Подключает aMagic.php из lib/aMagic/
   - Генерирует HTML-страницу на основе конфигурации
   - Предоставляет панель управления для создания новых страниц

## Особенности

1. **Автоматическое перемещение** - скрипт сам перемещает себя в папку библиотек после первого запуска.

2. **Гибкая конфигурация** - все настройки можно переопределять в отдельных файлах.

3. **Модульная структура** - страницы состоят из секций, которые можно легко менять.

4. **Панель управления** - встроенное меню для управления страницами.

5. **Два формата вывода**:
   - `$aMagic` - компактный HTML
   - `$aMagicF` - форматированный HTML с отступами

## Рекомендации по использованию

1. После первого запуска все изменения нужно вносить в сгенерированные файлы, а не в aMagic.php.

2. Основные настройки сайта хранятся в config.php.

3. Для создания новых страниц используйте форму в панели управления.

4. Для добавления своих стилей и скриптов используйте соответствующие файлы в папке static/.

5. HTML-код отдельных секций страниц размещайте в соответствующих файлах в папке pages/.
